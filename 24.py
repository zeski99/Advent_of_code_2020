print((lambda d:(lambda l:   (lambda s:(len(s),len([(s := s - {e for e in s if len({e+v for v in d.values() if e+v in s}) not in {1,2}} | {e for e in set().union(*[{c+v for v in d.values()} for c in s]) if len({e+v for v in d.values() if e+v in s}) == 2}) for i in range(100)][99])))({e for e in set(l) if l.count(e) % 2 == 1}))([sum((map(lambda x: d[x], [(lambda i: h[i] if i == 0 else h[i-1]+h[i] if h[i-1] in "ns" else h[i])(i) for i in range(len(h)) if h[i] not in "ns\n"]))) for h in open("24").readlines()]))({"e": 1, "w": -1, "ne": 1j, "nw": -1 + 1j, "se": 1 - 1j, "sw": -1j}))