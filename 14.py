print((lambda a, d, m, r:(([(lambda h,d,m: m.update({0:int(h[1].replace("X", "1"), 2), 1:int(h[1].replace("X", "0"), 2)}) if h[0] == "mask" else d.update({h[0]: (h[1] & m[0]) | m[1] }))(h,d,m) for h in a] and sum(d.values()))+ bool(d.clear()),([(lambda h,d,m: m.update({0:h[1].replace("1", "0"), 1:int(h[1].replace("X", "0"), 2)}) if h[0] == "mask" else r(lambda g, d, o, l, k, n: d.update({(k ^ int(o,2)) | l: n}) if not "X" in o else g(g,d,o.replace("X", "1", 1),l,k,n) or g(g,d,o.replace("X", "0", 1),l,k,n),d, m[0], m[1], h[0], h[1]))(h,d,m) for h in a] and sum(d.values()))))([(lambda k : k if k[0] == "mask" else [int(k[0][4:-1]), int(k[1])])(a.split(" = ")) for a in open("14").readlines()], dict(), dict(), lambda f, *x: f(f,*x)))