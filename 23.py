print((lambda f,a:((lambda a,s,l,d,f,p: f(a[0],a,s,l,d)*0 or p(0,d))(a,9,100,{a[i-1]:a[i] for i in range(len(a))},f,lambda c,d: (lambda h: "".join([str(c+1) for c in h]))([(c:= d[c]) for i in range(8)])),(lambda a, s, l, d, f,p: d.update({a[-1]:len(a)}) or d.update({i:i+1 for i in range(len(a), s)}) or d.update({s-1: a[0]}) or f(a[0],a,s,l,d)*0 or p(d))(a, 1000000, 10000000, {a[i]:a[i+1] for i in range(len(a)-1)}, f,lambda d: (d[0]+1) * (d[d[0]]+1))))(lambda c,a,s,l,d:[(c := (lambda c: (t := [d[c], d[d[c]], d[d[d[c]]]], z := max([c - 1 - j for j in range(4) if (c - 1 - j) % s not in t]) % s,d.update({c:d[t[2]]}), d.update({t[2]: d[z]}), d.update({z: t[0]}), c := d[c]))(c)[5]) for i in range(l)], [int(c) - 1 for c in open("23").read()]))